<!doctype html>
<html class="docs-version-current" lang="zh" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/zh/blog/rss.xml" title="ActiveJ 5.0 Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh/blog/atom.xml" title="ActiveJ 5.0 Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-176574648-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-176574648-1",{})</script><title data-react-helmet="true">ActiveJ | Datastreamï¼Œä»¥æœ€å°çš„å¼€é”€å®ç°å¼‚æ­¥ååº”å¼Javaæµ | ActiveJ 5.0</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://activej.io/zh/img/preview.png"><meta data-react-helmet="true" name="twitter:image" content="https://activej.io/zh/img/preview.png"><meta data-react-helmet="true" property="og:url" content="https://activej.io/zh/async-io/datastream"><meta data-react-helmet="true" name="docusaurus_locale" content="zh"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="ActiveJ | Datastreamï¼Œä»¥æœ€å°çš„å¼€é”€å®ç°å¼‚æ­¥ååº”å¼Javaæµ | ActiveJ 5.0"><meta data-react-helmet="true" name="description" content="å…·æœ‰æä½å¼€é”€çš„å¼‚æ­¥ååº”å¼Javaæµ"><meta data-react-helmet="true" property="og:description" content="å…·æœ‰æä½å¼€é”€çš„å¼‚æ­¥ååº”å¼Javaæµ"><meta data-react-helmet="true" name="keywords" content="æ•°æ®æµ,ååº”å¼æµ,å¼‚æ­¥ååº”å¼æµ,java,JAVAæ¡†æ¶"><link data-react-helmet="true" rel="shortcut icon" href="/zh/./img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://activej.io/zh/async-io/datastream"><link data-react-helmet="true" rel="alternate" href="https://activej.io/async-io/datastream" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://activej.io/zh/async-io/datastream" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://activej.io/ru/async-io/datastream" hreflang="ru"><link data-react-helmet="true" rel="alternate" href="https://activej.io/async-io/datastream" hreflang="x-default"><link rel="stylesheet" href="/zh/assets/css/styles.cd595f84.css">
<link rel="preload" href="/zh/assets/js/runtime~main.0e2f678d.js" as="script">
<link rel="preload" href="/zh/assets/js/main.e4125694.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">è·³åˆ°ä¸»è¦å†…å®¹</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh/"><img src="/zh/./img/logo.webp" alt="Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/zh/./img/logo.webp" alt="Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">ActiveJ</b></a><a class="navbar__item navbar__link navbar__link--active" href="/zh/overview">æ–‡ä»¶</a><a class="navbar__item navbar__link" href="/zh/tutorials/getting-started">æ•™ç¨‹</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_3vod"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>ä¸­æ–‡ (machine translation)</span></span></a><ul class="dropdown__menu"><li><a href="/async-io/datastream" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/zh/async-io/datastream" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">ä¸­æ–‡ (machine translation)</a></li><li><a href="/ru/async-io/datastream" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">Ğ ÑƒÑÑĞºĞ¸Ğ¹ (machine translation)</a></li></ul></div><a class="navbar__item navbar__link" href="/zh/blog">åšå®¢</a><a href="https://github.com/activej/activej" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/zh/overview">æ¦‚è¿°</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">å¼‚æ­¥I/O</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/zh/async-io/eventloop">äº‹ä»¶é“¾æ¥</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/zh/async-io/promise">æ‰¿è¯º</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/zh/async-io/csp">CSP</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh/async-io/datastream">æ•°æ®æµ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/zh/async-io/net">Net</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">é´å­</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">HTTP</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æ³¨å…¥</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ç¼–ç åŸºå› </a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ä¸²è¡Œå™¨</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ä¸“ä¸šäººå‘˜</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">RPC</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">é›‡å‘˜</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æ‚é¡¹</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">åœ¨è¿™ä¸€é¡µ</button></div><div class="theme-doc-markdown markdown"><header><h1>æ•°æ®æµ</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="æ¦‚è¿°"></a>æ¦‚è¿°<a class="hash-link" href="#æ¦‚è¿°" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">#</a></h2><p>Datastreamæ˜¯ä¸€ä¸ªéå¸¸å¿«é€Ÿçš„ååº”å¼æµçš„å®ç°ã€‚ å®ƒå¯¹æœåŠ¡å™¨å†…å’ŒæœåŠ¡å™¨é—´çš„ é€šä¿¡å’Œå¼‚æ­¥æ•°æ®å¤„ç†éå¸¸æœ‰ç”¨ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="ç‰¹ç‚¹"></a>ç‰¹ç‚¹<a class="hash-link" href="#ç‰¹ç‚¹" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">#</a></h2><ul><li>ä¸€ä¸ªç°ä»£çš„å¼‚æ­¥ååº”æµçš„å®ç°ï¼ˆä¸åŒäºJava 8ä¸­çš„æµå’Œä¼ ç»Ÿçš„åŸºäºçº¿ç¨‹çš„é˜»å¡æµï¼‰ã€‚</li><li>å…·æœ‰æå…¶æœ‰æ•ˆçš„èƒŒå‹æ§åˆ¶çš„å¼‚æ­¥æ€§ï¼Œä»¥å¤„ç†æ•°æ®æºé€Ÿåº¦çš„è‡ªç„¶ä¸å¹³è¡¡é—®é¢˜</li><li>å¯ç»„åˆçš„æµæ“ä½œï¼ˆæ˜ å°„å™¨ã€è¿˜åŸå™¨ã€è¿‡æ»¤å™¨ã€åˆ†ç±»å™¨ã€åˆå¹¶/æ‹†åˆ†å™¨ã€å‹ç¼©ã€åºåˆ—åŒ–ï¼‰ã€‚</li><li>åœ¨ <a href="/zh/async-io/eventloop">Eventloopæ¨¡å—ä¹‹ä¸Šçš„åŸºäºæµçš„ç½‘ç»œå’Œæ–‡ä»¶I/O</a></li><li>ä¸ <a href="/zh/async-io/csp">CSPæ¨¡å—ç›¸å…¼å®¹</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="ä¸cspçš„æ¯”è¾ƒ"></a>ä¸CSPçš„æ¯”è¾ƒ<a class="hash-link" href="#ä¸cspçš„æ¯”è¾ƒ" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">#</a></h2><p>Datastreamä¸CSPæ¨¡å—æœ‰å¾ˆå¤šå…±åŒä¹‹å¤„ã€‚ è™½ç„¶å®ƒä»¬éƒ½æ˜¯ä¸ºI/Oå¤„ç†è€Œè®¾è®¡çš„ï¼Œä½†æœ‰å‡ ä¸ªé‡è¦çš„åŒºåˆ«ã€‚</p><table><thead><tr><th></th><th>æ•°æ®æµ</th><th>CSP</th></tr></thead><tbody><tr><td><strong>ä¿¯è§†ã€‚</strong></td><td>æä½ï¼šæµå¯ä»¥ç”¨1ä¸ªè™šæ‹Ÿè°ƒç”¨å¯åŠ¨ï¼ŒçŸ­è·¯è¯„ä¼°ä¼˜åŒ–äº†æ€§èƒ½</td><td>æ²¡æœ‰çŸ­è·¯è¯„ä¼°ï¼Œå¼€é”€è¾ƒå¤§</td></tr><tr><td><strong>ååé€Ÿåº¦ã€‚</strong></td><td>é€Ÿåº¦æå¿« (<em>360 880 548 ops/sec</em>)</td><td>å¿« (<em>105 932 203 ops/sec</em>)ï¼Œä½†æ¯”Datastreamæ…¢ã€‚</td></tr><tr><td><strong>ä¼˜åŒ–çš„æ˜¯ã€‚</strong></td><td>å°å—çš„æ•°æ®</td><td>ä¸­ç­‰è§„æ¨¡çš„ç‰©ä½“ï¼Œ <a href="/zh/misc/bytebuf"><code>ByteBufs</code></a></td></tr><tr><td><strong>ç¼–ç¨‹æ¨¡å¼ã€‚</strong></td><td>æ›´åŠ å¤æ‚</td><td>ç®€å•è€Œæ–¹ä¾¿</td></tr></tbody></table><p>ä¸ºäº†æä¾›æœ€å¤§çš„æ•ˆç‡ï¼ŒActiveJå¹¿æ³›åˆ©ç”¨äº†CSPå’ŒDatastreamçš„ç»„åˆã€‚ ä¸ºäº†è¿™ä¸ªç›®çš„ã€‚ <a href="https://github.com/activej/activej/blob/v5.0/core-csp/src/main/java/io/activej/csp/ChannelSupplier.java" target="_blank">æ¸ é“ä¾›åº”å•†</a>, <a href="https://github.com/activej/activej/blob/v5.0/core-csp/src/main/java/io/activej/csp/ChannelConsumer.java" target="_blank">æ¸ é“æ¶ˆè´¹è€…&quot;ã€‚</a>, <a href="https://github.com/activej/activej/blob/v5.0/core-datastream/src/main/java/io/activej/datastream/StreamSupplier.java" target="_blank">æµåŠ¨ä¾›åº”å•†&quot;ã€‚</a> å’Œ <a href="https://github.com/activej/activej/blob/v5.0/core-datastream/src/main/java/io/activej/datastream/StreamConsumer.java" target="_blank">æµæ°´çº¿æ¶ˆè´¹è€…&quot;ï¼ˆStreamConsumerï¼‰ã€‚</a> æœ‰ <code>transformWith()</code> æ–¹æ³•å’Œç‰¹æ®Šçš„Transformeræ¥å£ã€‚ ä½¿ç”¨è¿™äº›æ–¹æ³•å’Œæ¥å£ï¼Œä½ å¯ä»¥å°†é€šé“æ— ç¼åœ°è½¬æ¢ä¸ºå…¶ä»–é€šé“æˆ–æ•°æ®æµï¼Œåä¹‹äº¦ç„¶ï¼Œåˆ›å»ºè¿™ç§è½¬æ¢çš„é“¾ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="åŸºå‡†"></a>åŸºå‡†<a class="hash-link" href="#åŸºå‡†" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">#</a></h2><p>æˆ‘ä»¬å·²ç»æµ‹é‡äº†Datastreamçš„æ€§èƒ½(<code>StreamSupplier</code> å°†100Mçš„æ•´æ•°å¯¹è±¡æµå‘ <code>StreamConsumer</code> åœºæ™¯) ï¼Œå¹¶å¾—åˆ°äº†ä»¥ä¸‹ç»“æœã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W bash"><pre tabindex="0" class="prism-code language-bash codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">æ—¶é—´ï¼š2771msï¼›å¹³å‡æ—¶é—´ï¼š277.1msï¼›æœ€ä½³æ—¶é—´ï¼š275msï¼›æœ€å·®æ—¶é—´ï¼š281msï¼›æ¯ç§’æ“ä½œæ•°ï¼š360 </span><span class="token number" style="color:#36acaa">880</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">548</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>æˆ‘ä»¬è¿˜æµ‹é‡äº†åŒæ—¶ä½¿ç”¨Datastreamå’ŒCSPçš„TCPæœåŠ¡å™¨æ€§èƒ½ï¼Œå¾—åˆ°çš„å¹³å‡ç»“æœæ˜¯ï¼š <strong>47 495 905æ¬¡/ç§’</strong>ã€‚</p><p>ä½ å¯ä»¥åœ¨ä»¥ä¸‹ç½‘ç«™æ‰¾åˆ°åŸºå‡†æ¥æº <a href="https://github.com/activej/activej/blob/v5.0/benchmarks/datastream/src/main/java/io/activej/datastream/DatastreamBenchmark.java" target="_blank"><strong>GitHub</strong></a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="å®ä¾‹"></a>å®ä¾‹<a class="hash-link" href="#å®ä¾‹" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">#</a></h2><ul><li><a href="#simple-supplier">ç®€å•çš„ä¾›åº”å•†</a> - å±•ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªç®€å•çš„ <code>StreamSupplier</code> ï¼Œå¹¶å°†ä¸€äº›æ•°æ®æµè½¬åˆ° <code>StreamConsumerã€‚</code></li><li><a href="#simple-consumer">ç®€å•çš„æ¶ˆè´¹è€…</a> - å±•ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªç®€å•çš„ <code>StreamConsumer</code></li><li><a href="#custom-transformer">è‡ªå®šä¹‰å˜å‹å™¨</a> - æ˜¾ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ <a href="https://github.com/activej/activej/blob/v5.0/core-datastream/src/main/java/io/activej/datastream/processor/StreamTransformer.java" target="_blank">&quot;æµåª’ä½“è½¬æ¢å™¨&quot;ã€‚</a>ï¼Œå®ƒæ¥æ”¶å­—ç¬¦ä¸²å¹¶å°†å…¶è½¬æ¢ä¸ºå…¶é•¿åº¦ï¼Œå¦‚æœå®ƒå°äº <code>MAX_LENGTH</code>ã€‚</li><li><a href="#built-in-stream-nodes">å†…ç½®æµèŠ‚ç‚¹ç¤ºä¾‹</a> - å±•ç¤ºäº†ä¸€äº›å†…ç½®Datastreamçš„å¯èƒ½æ€§ï¼Œå¦‚è¿‡æ»¤ã€åˆ†å‰²ã€è”åˆå’Œæ˜ å°„ã€‚</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>è¦è¿è¡Œä¾‹å­ï¼Œä½ éœ€è¦ä»GitHubå…‹éš†ActiveJ</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W shell"><pre tabindex="0" class="prism-code language-shell codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/activej/activej</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>å¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªMavené¡¹ç›®å¯¼å…¥ã€‚ æŸ¥çœ‹æ ‡ç­¾ <strong>v5.0</strong>ã€‚ åœ¨è¿è¡Œè¿™äº›ä¾‹å­ä¹‹å‰ï¼Œå…ˆå»ºç«‹é¡¹ç›®ã€‚ è¿™äº›ä¾‹å­ä½äº <code>activej/examples/core/datastreamã€‚</code></p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="ç®€å•çš„ä¾›åº”å•†"></a>ç®€å•çš„ä¾›åº”å•†<a class="hash-link" href="#ç®€å•çš„ä¾›åº”å•†" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">#</a></h3><p>å½“ä½ è¿è¡Œ <a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/datastream/src/main/java/SupplierExample.java" target="_blank">&quot;SupplierExample&quot;ï¼ˆä¾›åº”å•†å®ä¾‹ï¼‰ã€‚</a>ï¼Œä½ ä¼šçœ‹åˆ°ä»¥ä¸‹è¾“å‡ºã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W bash"><pre tabindex="0" class="prism-code language-bash codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">æ”¶åˆ°çš„æ¶ˆè´¹è€…ã€‚</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">]</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>è¿™ä¸ªè¾“å‡ºä»£è¡¨äº†æˆ‘ä»¬è‡ªå®šä¹‰çš„ <code>StreamSupplier</code> æä¾›ç»™ <code>StreamConsumer</code>çš„æ•°æ®ã€‚ è®©æˆ‘ä»¬æ¥çœ‹çœ‹ ï¼Œçœ‹ä¸€ä¸‹æ‰§è¡Œæƒ…å†µã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">public final class SupplierExample {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  public static void main(String[] args) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //create an eventloop for streams operations</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Eventloop eventloop = Eventloop.create().withCurrentThread();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //create a supplier of some numbers</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    StreamSupplier&lt;Integer&gt; supplier = StreamSupplier.of(0, 1, 2, 3, 4);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //creating a consumer for our supplier</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    StreamConsumerToList&lt;Integer&gt; consumer = StreamConsumerToList.create();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //streaming supplier&#x27;s numbers to consumer</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    supplier.streamTo(consumer);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //when stream completes, streamed data is printed out</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    consumer.getResult().whenResult(result -&gt; System.out.println(&quot;Consumer received: &quot; + result));</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //start eventloop</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    eventloop.run();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p><strong><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/datastream/src/main/java/SupplierExample.java" target="_blank">åœ¨GitHubä¸Šçœ‹åˆ°å®Œæ•´çš„ä¾‹å­</a></strong></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="ç®€å•çš„æ¶ˆè´¹è€…"></a>ç®€å•çš„æ¶ˆè´¹è€…<a class="hash-link" href="#ç®€å•çš„æ¶ˆè´¹è€…" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">#</a></h3><p>å½“ä½ è¿è¡Œ <a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/datastream/src/main/java/ConsumerExample.java" target="_blank"><code>æ¶ˆè´¹è€…å®ä¾‹</code></a>ï¼Œä½ ä¼šçœ‹åˆ°ä»¥ä¸‹è¾“å‡ºã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W bash"><pre tabindex="0" class="prism-code language-bash codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">æ”¶åˆ°ã€‚1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">æ”¶åˆ°ã€‚2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">æ”¶åˆ°ã€‚3</span></span><span class="token-line" style="color:#393A34"><span class="token plain">æ”¶åˆ°çš„æµç»“æŸ</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p><code>ConsumerExample</code> è¡¨ç¤ºä¸€ä¸ªè‡ªå®šä¹‰çš„æ¶ˆè´¹è€…ï¼Œå®ƒæ‰©å±•äº† <a href="https://github.com/activej/activej/blob/v5.0/core-datastream/src/main/java/io/activej/datastream/AbstractStreamConsumer.java" target="_blank"><code>AbstractStreamConsumer</code></a> è€Œåªæ˜¯æ‰“å°å‡ºæ”¶åˆ°çš„æ•°æ®ã€‚ æµåª’ä½“è¿‡ç¨‹æ˜¯é€šè¿‡é‡è½½æ–¹æ³• <code>onStarted()</code>, <code>onEndOfStream()</code> å’Œ <code>onError()</code>æ¥ç®¡ç†ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">public final class ConsumerExample&lt;T&gt; extends AbstractStreamConsumer&lt;T&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  protected void onStarted() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    resume(x -&gt; System.out.println(&quot;received: &quot; + x));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  protected void onEndOfStream() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(&quot;End of stream received&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    acknowledge();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  protected void onError(Exception t) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(&quot;Error handling logic must be here. No confirmation to upstream is needed&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p><strong><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/datastream/src/main/java/ConsumerExample.java" target="_blank">åœ¨GitHubä¸Šçœ‹åˆ°å®Œæ•´çš„ä¾‹å­</a></strong></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="å®šåˆ¶å˜å‹å™¨"></a>å®šåˆ¶å˜å‹å™¨<a class="hash-link" href="#å®šåˆ¶å˜å‹å™¨" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">#</a></h3><p><a href="#"><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/datastream/src/main/java/TransformerExample.java" target="_blank"><code>å˜æ¢å™¨å®ä¾‹</code></a></a> æ˜¾ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ <code>StreamTransformer</code> ï¼Œå®ƒä»è¾“å…¥æµä¸­è·å–å­—ç¬¦ä¸²ï¼Œå¦‚æœå…¶é•¿åº¦å°äºå®šä¹‰çš„ <code>MAX_LENGTH</code>ï¼Œåˆ™å¯¹å…¶è¿›è¡Œå˜æ¢ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ <code>AbstractStreamConsumer</code> å’Œ <a href="https://github.com/activej/activej/blob/v5.0/core-datastream/src/main/java/io/activej/datastream/AbstractStreamSupplier.java" target="_blank"><code>æŠ½è±¡æµä¾›åº”å•†</code></a>:</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">private final AbstractStreamConsumer&lt;String&gt; input = new AbstractStreamConsumer&lt;String&gt;() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  protected void onEndOfStream() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    output.sendEndOfStream();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">private final AbstractStreamSupplier&lt;Integer&gt; output = new AbstractStreamSupplier&lt;Integer&gt;() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  protected void onResumed() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    input.resume(item -&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      int len = item.length();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      if (len &lt; MAX_LENGTH) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        output.send(len);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    });</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  protected void onSuspended() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    input.suspend();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>ç°åœ¨æˆ‘ä»¬å®šä¹‰ <code>main</code> æ–¹æ³•ï¼Œå®ƒåˆ›å»ºä¸€ä¸ªæµ‹è¯•æ•°æ®çš„ä¾›åº”è€…ï¼Œä¸€ä¸ª <code>TransformerExample</code> çš„å®ä¾‹å’Œ <a href="https://github.com/activej/activej/blob/v5.0/core-datastream/src/main/java/io/activej/datastream/StreamConsumerToList.java" target="_blank"><code>StreamConsumerToList</code></a> æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰è½¬æ¢å’Œè¾“å‡ºçš„é¡ºåºã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">public static void main(String[] args) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Eventloop eventloop = Eventloop.create().withCurrentThread().withEventloopFatalErrorHandler(rethrow());</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamSupplier&lt;String&gt; source = StreamSupplier.of(&quot;testdata&quot;, &quot;testdata1&quot;, &quot;testdata1000&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  TransformerExample transformer = new TransformerExample();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamConsumerToList&lt;Integer&gt; consumer = StreamConsumerToList.create();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  source.transformWith(transformer).streamTo(consumer);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  consumer.getResult().whenResult(v -&gt; System.out.println(v));</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  eventloop.run();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>å¦‚æœä½ è¿è¡Œè¿™ä¸ªä¾‹å­ï¼Œä½ ä¼šæ”¶åˆ°ä»¥ä¸‹è¾“å‡ºã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">[8, 9]</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p><strong><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/datastream/src/main/java/TransformerExample.java" target="_blank">åœ¨GitHubä¸Šçœ‹åˆ°å®Œæ•´çš„ä¾‹å­</a></strong></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="å†…ç½®æµèŠ‚ç‚¹"></a>å†…ç½®æµèŠ‚ç‚¹<a class="hash-link" href="#å†…ç½®æµèŠ‚ç‚¹" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">#</a></h3><p><a href="#"><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/datastream/src/main/java/BuiltinNodesExample.java" target="_blank"><code>BuiltinStreamNodesExample</code></a></a> å±•ç¤ºäº†ä¸€äº›åˆ©ç”¨å†…ç½®æ•°æ®æµèŠ‚ç‚¹çš„ç®€å•ä¾‹å­ã€‚</p><p>ç¬¬ä¸€ä¸ªæ˜¯ <a href="https://github.com/activej/activej/blob/v5.0/core-datastream/src/main/java/io/activej/datastream/processor/StreamFilter.java" target="_blank">æµåª’ä½“è¿‡æ»¤å™¨&quot;ã€‚</a> å®ƒå…è®¸å°†ä¸€ä¸ªå‡½æ•°åº”ç”¨äºè¾“å…¥ï¼Œç„¶åå°†è¯¥å‡½æ•°çš„ç»“æœæµå‘ç›®çš„åœ°ã€‚ åœ¨è¿™ä¸ª ç‰¹å®šçš„ä¾‹å­ä¸­ <code>StreamFilter</code> è¿‡æ»¤è¾“å…¥çš„æ•°å­—ï¼Œç„¶åæµå‘æ¶ˆè´¹è€…åªæœ‰å¥‡æ•°ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">private static void filter() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamSupplier&lt;Integer&gt; supplier = StreamSupplier.of(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamFilter&lt;Integer, Integer&gt; filter = StreamFilter.create(input -&gt; input % 2 == 1);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamConsumerToList&lt;Integer&gt; consumer = StreamConsumerToList.create();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  supplier.transformWith(filter).streamTo(consumer);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  consumer.getResult().whenResult(v -&gt; System.out.println(v));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>è¿™ä¸ªä¾‹å­çš„è¾“å‡ºæ˜¯ <code>[1, 3, 5, 7, 9]</code>ï¼Œè€Œæµçš„å›¾å½¢ç›¸å½“ç®€å•ï¼Œçœ‹èµ·æ¥å¦‚ä¸‹ã€‚</p><div class="mermaid">
graph TD
    id1(StreamSuppliers$OfIterator)--&gt;id2(StreamFilter$Input)--&gt;id3([StreamFilter])--&gt;id4(StreamFilter$Output)--&gt;id5(StreamConsumerToList)
    style id1 stroke:#3578ep,stroke-width:2px
    style id2 stroke:#fa383e,stroke-width:2px
    style id3 stroke:#a4a6a8,stroke-width:2px
    style id4 stroke:#3578ep, stroke-width:2px
    style id5 stroke:#fa383e, stroke-width:2px
</div><p>å¦ä¸€ä¸ªå†…ç½®çš„æµèŠ‚ç‚¹æ˜¯ <a href="https://github.com/activej/activej/blob/v5.0/core-datastream/src/main/java/io/activej/datastream/processor/StreamFilter.java" target="_blank">&quot;StreamFilter::mapper&quot;ã€‚</a></p><p>å®ƒæ ¹æ®ç»™å®šçš„å‡½æ•°æ”¹å˜æ¯ä¸ªè¾“å…¥é¡¹ï¼Œä¾‹å¦‚ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">private static void mapper() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //creating a supplier of 10 numbers</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamSupplier&lt;Integer&gt; supplier = StreamSupplier.of(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //creating a mapper for the numbers</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamFilter&lt;Integer, String&gt; simpleMap = StreamFilter.mapper(x -&gt; x + &quot; times ten = &quot; + x * 10);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //creating a consumer which converts received values to list</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamConsumerToList&lt;String&gt; consumer = StreamConsumerToList.create();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //applying the mapper to supplier and streaming the result to consumer</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  supplier.transformWith(simpleMap).streamTo(consumer);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //when consumer completes receiving values, the result is printed out</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  consumer.getResult().whenResult(v -&gt; System.out.println(v));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>è¿™ä¸ªä¾‹å­çš„è¾“å‡ºæ˜¯</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W"><pre tabindex="0" class="prism-code language-undefined codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">[</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    1æ¬¡å=10,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    2æ¬¡å=20,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    3æ¬¡å=30,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    4æ¬¡å=40,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    5æ¬¡å=50,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    6æ¬¡å=60,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    7æ¬¡å=70,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    8æ¬¡å=80,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    9æ¬¡å=90,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    10æ¬¡å=100</span></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>å’Œæµçš„å›¾å½¢çœ‹èµ·æ¥å¦‚ä¸‹ã€‚</p><div class="mermaid">
graph TD
    id1(StreamSuppliers$OfIterator)--&gt;id2(StreamMapper$Input)--&gt;id3([StreamMapper])--&gt;id4(StreamMapper$Output)--&gt;id5(StreamConsumerToList)
    style id1 stroke:#3578ep,stroke-width:2px
    style id2 stroke:#fa383e,stroke-width:2px
    style id3 stroke:#a4a6a8,stroke-width:2px
    style id4 stroke:#3578ep, stroke-width:2px
    style id5 stroke:#fa383e, stroke-width:2px
</div><p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦ä¸€ä¸ªå†…ç½®èŠ‚ç‚¹ <a href="https://github.com/activej/activej/blob/v5.0/core-datastream/src/main/java/io/activej/datastream/processor/StreamSplitter.java" target="_blank">&quot;StreamSplitter&quot;(åˆ†æµå™¨)</a></p><p>å®ƒæ˜¯ä¸€ä¸ªæµè½¬åŒ–å™¨ï¼Œæ ¹æ®æä¾›çš„å‡½æ•°åˆ†é…è¾“å…¥æµã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®ƒ ï¼Œåœ¨3ä¸ªæ¶ˆè´¹è€…ä¹‹é—´åˆ†é…10ä¸ªæ•°å­—ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">private static void splitter() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamSupplier&lt;Integer&gt; supplier = StreamSupplier.of(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ToIntFunction&lt;Object&gt; hashSharder = item -&gt; (item.hashCode() &amp; Integer.MAX_VALUE) % 3;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //creating a sharder of three parts for three consumers</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamSplitter&lt;Integer, Integer&gt; sharder = StreamSplitter.create(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      (item, acceptors) -&gt; acceptors[hashSharder.applyAsInt(item)].accept(item));</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamConsumerToList&lt;Integer&gt; first = StreamConsumerToList.create();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamConsumerToList&lt;Integer&gt; second = StreamConsumerToList.create();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamConsumerToList&lt;Integer&gt; third = StreamConsumerToList.create();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  sharder.newOutput().streamTo(first);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  sharder.newOutput().streamTo(second);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  sharder.newOutput().streamTo(third);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  supplier.streamTo(sharder.getInput());</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  first.getResult().whenResult(x -&gt; System.out.println(&quot;first: &quot; + x));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  second.getResult().whenResult(x -&gt; System.out.println(&quot;second: &quot; + x));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  third.getResult().whenResult(x -&gt; System.out.println(&quot;third: &quot; + x));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨å¿«æ·æ–¹æ³• <code>transformWith</code> ï¼Œå› ä¸ºå®ƒåªèƒ½ ï¼Œç”¨äºæ­£å¥½æœ‰ä¸€ä¸ªè¾“å…¥å’Œä¸€ä¸ªè¾“å‡ºæµçš„å˜æ¢å™¨ã€‚</p></div></div><p>è¿™ä¸ªä¾‹å­çš„è¾“å‡ºæ˜¯</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W"><pre tabindex="0" class="prism-code language-undefined codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">ç¬¬ä¸€ã€‚[3ï¼Œ6ï¼Œ9]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ç¬¬äºŒï¼š[1ï¼Œ4ï¼Œ7ï¼Œ10]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ç¬¬ä¸‰ï¼š[2ï¼Œ5ï¼Œ8]`ã€‚</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>è€Œæµå‘å›¾çœ‹èµ·æ¥å¦‚ä¸‹ã€‚</p><div class="mermaid">
graph TD;
    id7(StreamSuppliers$OfIterator):::blue--&gt;id8(StreamSplitter$Input);
    id8--&gt;StreamSplitter:::grey;
    StreamSplitter--&gt;id1(StreamSplitter$Output);
    StreamSplitter--&gt;id2(StreamSplitter$Output);
    StreamSplitter--&gt;id3(StreamSplitter$Output);
    id1--&gt;id4(StreamConsumerToList);
    id2--&gt;id5(StreamConsumerToList);
    id3--&gt;id6(StreamConsumerToList);
</div><p>å½“ä½ åˆ›å»º <strong>StreamSplitter</strong>ï¼Œä½ å¯ä»¥åœ¨lambdaä¸­æä¾›ä»»ä½•å‡½æ•°ã€‚ å¯¹äº ï¼Œè¦åˆ›å»ºä¸€ä¸ªå°†æ‰€æœ‰è¾“å…¥æ•°æ®å‘é€è‡³æ‰€æœ‰æ¶ˆè´¹è€…çš„è½¬åŒ–å™¨ï¼Œåªéœ€åˆ›å»ºä»¥ä¸‹lambdaè¡¨è¾¾å¼ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">(item, acceptors) -&gt; {for (StreamDataAcceptor&lt;Integer&gt; acceptor : acceptors) { acceptor.accept(item);}}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¾“å‡ºå°†æ˜¯</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">ç¬¬ä¸€ç¯‡[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ç¬¬äºŒæ¬¡ï¼š[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ç¬¬ä¸‰æ¬¡ï¼š[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>æœ€åï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ <a href="https://github.com/activej/activej/blob/v5.0/core-datastream/src/main/java/io/activej/datastream/processor/StreamUnion.java" target="_blank">&quot;StreamUnion</a> å®ƒçš„ä½œç”¨ä¸ <code>StreamSplitter</code> ç›¸åï¼Œå¹¶å°†å‡ ä¸ªè¾“å…¥æµç»Ÿä¸€ä¸ºä¸€ä¸ªè¾“å‡ºã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">private static void union() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //creating three suppliers of numbers</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamSupplier&lt;Integer&gt; source0 = StreamSupplier.of(1, 2);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamSupplier&lt;Integer&gt; source1 = StreamSupplier.of();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamSupplier&lt;Integer&gt; source2 = StreamSupplier.of(3, 4, 5);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //creating a unifying transformer</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamUnion&lt;Integer&gt; streamUnion = StreamUnion.create();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //creating a consumer which converts received values to list</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  StreamConsumerToList&lt;Integer&gt; consumer = StreamConsumerToList.create();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //stream the sources into new inputs of the unifier</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  source0.streamTo(streamUnion.newInput());</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  source1.streamTo(streamUnion.newInput());</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  source2.streamTo(streamUnion.newInput());</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //and stream the output of the unifier into the consumer</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  streamUnion.getOutput().streamTo(consumer);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  //when consumer completes receiving values, the result is printed out</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  consumer.getResult().whenResult(v -&gt; System.out.println(v));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>è¿™ä¸ªä¾‹å­çš„è¾“å‡ºæ˜¯ <code>[1, 2, 3, 4, 5]</code> ï¼Œæµçš„å›¾å½¢çœ‹èµ·æ¥å¦‚ä¸‹ã€‚</p><div class="mermaid">
graph TD;
    id1(StreamSuppliers$OfIterator)--&gt;id2(StreamUnion$Input);
    id3(StreamSuppliers$OfIterator)--&gt;id4(StreamUnion$Input);
    id5(StreamSuppliers$OfIterator)--&gt;id6(StreamUnion$Input);
    id2--&gt;StreamUnion;
    id4--&gt;StreamUnion;
    id6--&gt;StreamUnion;
    StreamUnion--&gt;StreamUnion$Output;
    StreamUnion$Output--&gt;StreamConsumerToList;
</div><p><strong><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/datastream/src/main/java/BuiltinNodesExample.java" target="_blank">åœ¨GitHubä¸Šçœ‹åˆ°å®Œæ•´çš„ä¾‹å­</a></strong></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="æ–‡æ¡£é¡µé¢å¯¼èˆª"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh/async-io/csp"><div class="pagination-nav__sublabel">ä¸Šä¸€ç¯‡</div><div class="pagination-nav__label">Â« CSP</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zh/async-io/net"><div class="pagination-nav__sublabel">ä¸‹ä¸€é¡µ</div><div class="pagination-nav__label">Net Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#æ¦‚è¿°" class="table-of-contents__link">æ¦‚è¿°</a></li><li><a href="#ç‰¹ç‚¹" class="table-of-contents__link">ç‰¹ç‚¹</a></li><li><a href="#ä¸cspçš„æ¯”è¾ƒ" class="table-of-contents__link">ä¸CSPçš„æ¯”è¾ƒ</a></li><li><a href="#åŸºå‡†" class="table-of-contents__link">åŸºå‡†</a></li><li><a href="#å®ä¾‹" class="table-of-contents__link">å®ä¾‹</a><ul><li><a href="#ç®€å•çš„ä¾›åº”å•†" class="table-of-contents__link">ç®€å•çš„ä¾›åº”å•†</a></li><li><a href="#ç®€å•çš„æ¶ˆè´¹è€…" class="table-of-contents__link">ç®€å•çš„æ¶ˆè´¹è€…</a></li><li><a href="#å®šåˆ¶å˜å‹å™¨" class="table-of-contents__link">å®šåˆ¶å˜å‹å™¨</a></li><li><a href="#å†…ç½®æµèŠ‚ç‚¹" class="table-of-contents__link">å†…ç½®æµèŠ‚ç‚¹</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021å¹´ ActiveJ LLC.ä¿ç•™æ‰€æœ‰æƒåˆ©</div></div></div></footer></div>
<script src="/zh/assets/js/runtime~main.0e2f678d.js"></script>
<script src="/zh/assets/js/main.e4125694.js"></script>
</body>
</html>