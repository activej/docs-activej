<!doctype html>
<html class="docs-version-current" lang="zh" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/zh/blog/rss.xml" title="ActiveJ 5.1 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh/blog/atom.xml" title="ActiveJ 5.1 Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-176574648-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-176574648-1",{})</script><title data-react-helmet="true">å®ä¾‹ | ActiveJ 5.1</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://activej.io/zh/img/preview.png"><meta data-react-helmet="true" name="twitter:image" content="https://activej.io/zh/img/preview.png"><meta data-react-helmet="true" property="og:url" content="https://activej.io/zh/http/examples"><meta data-react-helmet="true" name="docusaurus_locale" content="zh"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="å®ä¾‹ | ActiveJ 5.1"><meta data-react-helmet="true" name="description" content="* Simple &quot;Hello World&quot; Server - simple async server created using"><meta data-react-helmet="true" property="og:description" content="* Simple &quot;Hello World&quot; Server - simple async server created using"><link data-react-helmet="true" rel="shortcut icon" href="/zh/./img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://activej.io/zh/http/examples"><link data-react-helmet="true" rel="alternate" href="https://activej.io/http/examples" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://activej.io/zh/http/examples" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://activej.io/ru/http/examples" hreflang="ru"><link data-react-helmet="true" rel="alternate" href="https://activej.io/http/examples" hreflang="x-default"><link rel="stylesheet" href="/zh/assets/css/styles.ebdfb6ec.css">
<link rel="preload" href="/zh/assets/js/runtime~main.c90fdde9.js" as="script">
<link rel="preload" href="/zh/assets/js/main.cfdcbb5a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">è·³åˆ°ä¸»è¦å†…å®¹</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh/"><div class="navbar__logo"><img src="/zh/./img/logo.webp" alt="Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/zh/./img/logo.webp" alt="Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">ActiveJ</b></a><a class="navbar__item navbar__link navbar__link--active" href="/zh/overview">æ–‡ä»¶</a><a class="navbar__item navbar__link" href="/zh/tutorials/getting-started">æ•™ç¨‹</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/zh/blog">åšå®¢</a><a href="https://github.com/activej/activej" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ğŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ğŸŒ</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh/overview">æ¦‚è¿°</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å¼‚æ­¥I/O</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">é´å­</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">HTTP</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/http">æ¦‚è¿°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/http/benchmarks">åŸºå‡†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh/http/examples">å®ä¾‹</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æ³¨å…¥</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ç¼–ç åŸºå› </a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ä¸²è¡Œå™¨</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ä¸“ä¸šäººå‘˜</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">RPC</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">é›‡å‘˜</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æ‚é¡¹</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">åœ¨è¿™ä¸€é¡µ</button></div><div class="theme-doc-markdown markdown"><header><h1>å®ä¾‹</h1></header><ul><li><a href="#simple-hello-world-server">Simple &quot;Hello World&quot; Server</a> - simple async server created using <a href="https://github.com/activej/activej/blob/v5.0/core-http/src/main/java/io/activej/http/AsyncHttpServer.java" target="_blank">AsyncHttpServer</a></li><li><a href="#hello-world-server-with-pre-defined-launcher">&quot;Hello World &quot;æœåŠ¡å™¨ä¸é¢„å®šä¹‰çš„å¯åŠ¨å™¨</a> - HTTPæ¨¡å—ä¸ºä½ æä¾›äº†ä¸€äº›é¢„å®šä¹‰çš„å¯åŠ¨å™¨ï¼Œä½¿ç”¨å®ƒä»¬æ¥åˆ›å»ºæœåŠ¡å™¨æ˜¯éå¸¸ç®€å•çš„ã€‚</li><li><a href="#custom-server">è‡ªå®šä¹‰æœåŠ¡å™¨</a> - ä½¿ç”¨ <a href="/zh/boot/launcher"><strong>å¯åŠ¨å™¨</strong></a>ä»å¤´å¼€å§‹åˆ›å»ºæœåŠ¡å™¨çš„ä¾‹å­ã€‚</li><li><a href="#multithreaded-server-example">å¤šçº¿ç¨‹æœåŠ¡å™¨å®ä¾‹</a> - HTTPå¤šçº¿ç¨‹æœåŠ¡å™¨å®ä¾‹ã€‚</li><li><a href="#request-parameters-example">è¯·æ±‚å‚æ•°ç¤ºä¾‹</a> - å¸¦å‚æ•°çš„è¯·æ±‚å¤„ç†ç¤ºä¾‹ã€‚</li><li><a href="#static-servlet-example">é™æ€Servletå®ä¾‹</a> - åˆ©ç”¨ <a href="https://github.com/activej/activej/blob/v5.0/core-http/src/main/java/io/activej/http/StaticServlet.java" target="_blank">AsyncHttpServer</a> çš„å®ä¾‹ã€‚</li><li><a href="#routing-servlet-example">Routing Servlet ç¤ºä¾‹</a> - <code>RoutingServlet çš„ç¤ºä¾‹</code> ç”¨äºåˆ›å»º servlet æ ‘ã€‚</li><li><a href="#dynamic-routing-examples">åŠ¨æ€è·¯ç”±ç¤ºä¾‹</a> - åŸºäºä¸»æœºã€cookieã€MIMEç±»å‹ç­‰çš„è·¯ç”±çš„å„ç§ç¤ºä¾‹ã€‚</li><li><a href="#routing-servlet-multibinder">Routing Servlet Multibinder</a> - ä½¿ç”¨ <strong>Multibinder</strong> æ¥åˆå¹¶å†²çªçš„ <code>RoutingServlet</code>sçš„ä¾‹å­ã€‚</li><li><a href="#blocking-servlet-example">Blocking Servlet ç¤ºä¾‹</a> - åœ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹ä¸­å¤„ç†æœåŠ¡å™¨ä¸Šçš„å¤æ‚æ“ä½œçš„ä¾‹å­ã€‚</li><li><a href="#file-upload-example">æ–‡ä»¶ä¸Šä¼ å®ä¾‹</a> - ä»å®¢æˆ·ç«¯æœ¬åœ°å­˜å‚¨ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨çš„å®ä¾‹ã€‚</li><li><a href="#client-example">å®¢æˆ·ç«¯å®ä¾‹</a> - åˆ©ç”¨ <strong>å¯åŠ¨å™¨åˆ›å»ºä¸€ä¸ª HTTP å®¢æˆ·ç«¯</strong>ã€‚</li><li><a href="#multipart-data-handling-example">å¤šéƒ¨åˆ†æ•°æ®å¤„ç†å®ä¾‹</a> - ç®€å•çš„æœåŠ¡å™¨ï¼Œå¤„ç† <strong>å¤šéƒ¨åˆ†/è¡¨å•æ•°æ®</strong></li><li><a href="#websocket-pong-server">WebSocket EchoæœåŠ¡å™¨å®ä¾‹</a> - ä½¿ç”¨WebSocketé€šä¿¡åè®®åˆ›å»ºä¸€ä¸ªåŸºæœ¬æœåŠ¡å™¨ã€‚</li><li><a href="#websocket-ping-client">WebSocketå®¢æˆ·ç«¯å®ä¾‹</a> - è®¾ç½®ä¸€ä¸ªå…·æœ‰WebSocketé€šä¿¡åè®®çš„å®¢æˆ·ç«¯ã€‚</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>è¦è¿è¡Œè¿™äº›ä¾‹å­ï¼Œä½ éœ€è¦ä»GitHubä¸Šå…‹éš†ActiveJã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W shell"><pre tabindex="0" class="prism-code language-shell codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/activej/activej</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>å¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªMavené¡¹ç›®å¯¼å…¥ã€‚ æŸ¥çœ‹æ ‡ç­¾ <strong>v5.0</strong>ã€‚ åœ¨è¿è¡Œè¿™äº›ä¾‹å­ä¹‹å‰ï¼Œå…ˆå»ºç«‹é¡¹ç›®ã€‚ è¿™äº›ä¾‹å­ä½äº <code>activej/examples/core/http</code></p></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="ç®€å•çš„-hello-world-æœåŠ¡å™¨">ç®€å•çš„ &quot;Hello World &quot;æœåŠ¡å™¨<a aria-hidden="true" class="hash-link" href="#ç®€å•çš„-hello-world-æœåŠ¡å™¨" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p><a href="#"><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/HelloWorldExample.java" target="_blank">HelloWorldExample</a></a> ä½¿ç”¨ <strong>AsyncHttpServer</strong> HTTPæ¨¡å—çš„ç±»ã€‚ å®ƒæ˜¯ä¸€ä¸ªéé˜»å¡å¼çš„æœåŠ¡å™¨ï¼Œåœ¨ä¸€ä¸ªäº‹ä»¶å¾ªç¯ä¸­å·¥ä½œã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">public static void main(String[] args) throws IOException {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Eventloop eventloop = Eventloop.create();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  AsyncHttpServer server = AsyncHttpServer.create(eventloop,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      request -&gt; HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          .withPlainText(&quot;Hello world!&quot;))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .withListenPort(8080);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  server.listen();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  System.out.println(&quot;Server is running&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  System.out.println(&quot;You can connect from browser by visiting &#x27;http://localhost:8080/&#x27;&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  eventloop.run();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>è¯¥æœåŠ¡å™¨åœ¨æä¾›çš„äº‹ä»¶ç¯ä¸­è¿è¡Œï¼Œå¹¶ç­‰å¾…ç«¯å£ <code>8080</code>çš„è¿æ¥ã€‚ å½“æœåŠ¡å™¨æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œå®ƒä¼šå‘å›ä¸€ä¸ª <strong>Promise</strong> çš„é—®å€™å›åº”ã€‚</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>è¦åœ¨ <code>AsyncHttpServer</code> ä¸­æ·»åŠ å¯¹HTTPSçš„æ”¯æŒï¼Œä½ éœ€è¦è°ƒç”¨ <code>withSslListenAddress</code> æˆ– <code>withSslListenAddresses</code> æ–¹æ³•ï¼Œå¹¶ä¼ é€’ <code>SSLContext</code>, <code>Executor</code>, å’Œä¸€ä¸ªç”¨äºç›‘å¬æœåŠ¡å™¨çš„ç«¯å£æˆ–åœ°å€ã€‚</p></div></div><p>è¦æ£€æŸ¥è¿™ä¸ªä¾‹å­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæ‰“å¼€ä½ å–œæ¬¢çš„æµè§ˆå™¨ï¼Œè¿›å…¥ <a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">localhost:8080</a>ã€‚
<a href="#"><a style="display:block;margin-bottom:16px" href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/HelloWorldExample.java" target="_blank">åœ¨GitHubä¸Šçœ‹åˆ°å®Œæ•´çš„ä¾‹å­</a></a></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="å¸¦æœ‰é¢„å®šä¹‰å¯åŠ¨å™¨çš„-hello-world-æœåŠ¡å™¨">å¸¦æœ‰é¢„å®šä¹‰å¯åŠ¨å™¨çš„ &quot;Hello World &quot;æœåŠ¡å™¨<a aria-hidden="true" class="hash-link" href="#å¸¦æœ‰é¢„å®šä¹‰å¯åŠ¨å™¨çš„-hello-world-æœåŠ¡å™¨" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p><strong>Launcher</strong>ï¼Œç®¡ç†åº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶å…è®¸ä»¥ä¸€ç§ç®€å•çš„æ–¹å¼åˆ›å»ºåº”ç”¨ç¨‹åºã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">public final class HttpHelloWorldExample extends HttpServerLauncher {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  AsyncServlet servlet() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return request -&gt; HttpResponse.ok200().withPlainText(&quot;Hello World&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  public static void main(String[] args) throws Exception {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launcher launcher = new HttpHelloWorldExample();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    launcher.launch(args);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>ä½ æ‰€éœ€è¦åšçš„å°±æ˜¯æä¾›ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„Servletï¼Œå¹¶å¯åŠ¨åº”ç”¨ç¨‹åºã€‚ <a href="https://github.com/activej/activej/blob/v5.0/launchers/http/src/main/java/io/activej/launchers/http/HttpServerLauncher.java" target="_blank">HttpServerLauncher</a>  ï¼Œå…¶ä»–çš„äº‹æƒ…éƒ½ä¼šå¤„ç†å¥½ã€‚
<a href="#"><a href="https://github.com/activej/activej/blob/examples-5.0/examples/tutorials/getting-started/src/main/java/HttpHelloWorldExample.java" target="_blank">See full example on GitHub</a></a></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="è‡ªå®šä¹‰æœåŠ¡å™¨">è‡ªå®šä¹‰æœåŠ¡å™¨<a aria-hidden="true" class="hash-link" href="#è‡ªå®šä¹‰æœåŠ¡å™¨" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p>é€šè¿‡ <strong>Launcher</strong> ï¼Œä½ å¯ä»¥è½»æ¾åœ°ä»å¤´å¼€å§‹åˆ›å»ºHTTPæœåŠ¡å™¨ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªç®€å•çš„æœåŠ¡å™¨ï¼Œ å‘é€ä¸€ä¸ªé—®å€™è¯­ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">public final class CustomHttpServerExample extends Launcher {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  private static final int PORT = 8080;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  Eventloop eventloop() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return Eventloop.create();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  AsyncServlet servlet() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return request -&gt; HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .withPlainText(&quot;Hello from HTTP server&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Eager</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  AsyncHttpServer server(Eventloop eventloop, AsyncServlet servlet) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return AsyncHttpServer.create(eventloop, servlet).withListenPort(PORT);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  protected Module getModule() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return ServiceGraphModule.create();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  protected void run() throws Exception {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    logger.info(&quot;HTTP Server is now available at http://localhost:&quot; + PORT);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    awaitShutdown();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  public static void main(String[] args) throws Exception {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launcher launcher = new CustomHttpServerExample();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    launcher.launch(args);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>é¦–å…ˆï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼Œä¸€ä¸ªServletï¼Œä»¥åŠä¸€ä¸ªå¼‚æ­¥æœåŠ¡å™¨æœ¬èº«ã€‚ ç„¶åï¼Œæˆ‘ä»¬è¦†ç›– <em>getModule</em> æ–¹æ³•ï¼Œä¸ºæˆ‘ä»¬çš„æœåŠ¡å™¨æä¾› é…ç½®å’Œ <a href="https://github.com/activej/activej/blob/v5.0/boot-servicegraph/src/main/java/io/activej/service/ServiceGraphModule.java" target="_blank">ServiceGraphModule</a> ï¼Œä»¥æ„å»ºæœåŠ¡çš„ä¾èµ–å›¾ã€‚
æœ€åï¼Œæˆ‘ä»¬è¦†ç›– <code>Launcher</code> ä¸»æ–¹æ³• <code>run()</code> ï¼Œç„¶åå®šä¹‰ <code>ç¤ºä¾‹çš„ä¸»</code> æ–¹æ³•ã€‚
è¦æ£€æŸ¥è¿™ä¸ªä¾‹å­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæ‰“å¼€ä½ å–œæ¬¢çš„æµè§ˆå™¨ï¼Œè¿›å…¥ <a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">localhost:8080</a>
<a href="#"><a style="display:block;margin-bottom:16px" href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/CustomHttpServerExample.java" target="_blank">See full example on GitHub</a></a></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="å¤šçº¿ç¨‹æœåŠ¡å™¨å®ä¾‹">å¤šçº¿ç¨‹æœåŠ¡å™¨å®ä¾‹<a aria-hidden="true" class="hash-link" href="#å¤šçº¿ç¨‹æœåŠ¡å™¨å®ä¾‹" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨é¢„å®šä¹‰çš„ <a href="https://github.com/activej/activej/blob/v5.0/launchers/http/src/main/java/io/activej/launchers/http/MultithreadedHttpServerLauncher.java" target="_blank">MultithreadedHttpServerLauncher</a> æ¥åˆ›å»ºä¸€ä¸ªå¤šçº¿ç¨‹çš„HTTPæœåŠ¡å™¨ã€‚ æ ¹æ® ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå°†æœ‰4ä¸ªworker servletsï¼Œ <em>workerId</em>sã€‚ æ¯ä¸ªäººéƒ½ä¼šå‘å›ä¸€ä¸ªé—®å€™è¯­å’Œä¸ºè¿æ¥æä¾›æœåŠ¡çš„å·¥ä½œè€… çš„å·ç ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">public final class MultithreadedHttpServerExample extends MultithreadedHttpServerLauncher {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Worker</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  AsyncServlet servlet(@WorkerId int workerId) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return request -&gt; HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .withPlainText(&quot;Hello from worker server #&quot; + workerId + &quot;\n&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  public static void main(String[] args) throws Exception {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    MultithreadedHttpServerExample example = new MultithreadedHttpServerExample();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    example.launch(args);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>è¦æ£€æŸ¥è¿™ä¸ªä¾‹å­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæ‰“å¼€ä½ å–œæ¬¢çš„æµè§ˆå™¨ï¼Œè¿›å…¥ <a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">localhost:8080</a>
<a href="#"><a style="display:block;margin-bottom:16px" href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/MultithreadedHttpServerExample.java" target="_blank">See full example on GitHub</a></a></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="è¯·æ±‚å‚æ•°ç¤ºä¾‹">è¯·æ±‚å‚æ•°ç¤ºä¾‹<a aria-hidden="true" class="hash-link" href="#è¯·æ±‚å‚æ•°ç¤ºä¾‹" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p>è¿™ä¸ªä¾‹å­ä»£è¡¨äº†å¸¦æœ‰å‚æ•°çš„è¯·æ±‚ï¼Œè¿™äº›å‚æ•°æ˜¯é€šè¿‡æ–¹æ³• <code>getPostParameters</code> å’Œ <code>getQueryParameter æ”¶åˆ°çš„ã€‚</code></p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">@Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">AsyncServlet servlet(Executor executor) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return RoutingServlet.create()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(POST, &quot;/hello&quot;, request -&gt; request.loadBody()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          .map($ -&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            String name = request.getPostParameters().get(&quot;name&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            return HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                .withHtml(&quot;&lt;h1&gt;&lt;center&gt;Hello from POST, &quot; + name + &quot;!&lt;/center&gt;&lt;/h1&gt;&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          }))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(GET, &quot;/hello&quot;, request -&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        String name = request.getQueryParameter(&quot;name&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            .withHtml(&quot;&lt;h1&gt;&lt;center&gt;Hello from GET, &quot; + name + &quot;!&lt;/center&gt;&lt;/h1&gt;&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      })</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(&quot;/*&quot;, StaticServlet.ofClassPath(executor, RESOURCE_DIR)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          .withIndexHtml());</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>è¦æ£€æŸ¥è¿™ä¸ªä¾‹å­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæ‰“å¼€ä½ å–œæ¬¢çš„æµè§ˆå™¨ï¼Œè¿›å…¥ <a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">localhost:8080</a>
<a href="#"><a style="display:block;margin-bottom:16px" href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/HttpRequestParametersExample.java" target="_blank">See full example on GitHub</a></a></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="é™æ€servletå®ä¾‹">é™æ€Servletå®ä¾‹<a aria-hidden="true" class="hash-link" href="#é™æ€servletå®ä¾‹" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p>å±•ç¤ºäº†å¦‚ä½•è®¾ç½®å’Œåˆ©ç”¨ <a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/HttpRequestParametersExample.java" target="_blank">StaticServlet</a> ï¼Œä»¥åˆ›å»ºå…·æœ‰ä¸€äº›é™æ€å†…å®¹çš„servletsï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒå°†ä» <code>static/site</code> ç›®å½•ä¸­è·å¾— å†…å®¹ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">@Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">AsyncServlet servlet(Executor executor) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return StaticServlet.ofClassPath(executor, &quot;static/site&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .withIndexHtml();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>è¦æ£€æŸ¥è¿™ä¸ªä¾‹å­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæ‰“å¼€ä½ å–œæ¬¢çš„æµè§ˆå™¨ï¼Œè¿›å…¥ <a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">localhost:8080</a>
<a href="#"><a style="display:block;margin-bottom:16px" href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/StaticServletExample.java" target="_blank">See full example on GitHub</a></a></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="routing-servletç¤ºä¾‹">Routing Servletç¤ºä¾‹<a aria-hidden="true" class="hash-link" href="#routing-servletç¤ºä¾‹" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p>ä»£è¡¨äº†å¦‚ä½•è®¾ç½®servletè·¯ç”±æ ‘ã€‚ è¿™ä¸ªè¿‡ç¨‹ç±»ä¼¼äºå¿«é€’æ–¹å¼ã€‚ è¦æ·»åŠ ä¸€ä¸ªè·¯ç”±åˆ°ä¸€ä¸ª <a href="https://github.com/activej/activej/blob/v5.0/core-http/src/main/java/io/activej/http/RoutingServlet.java" target="_blank">RoutingServlet</a>ï¼Œä½ åº”è¯¥ä½¿ç”¨æ–¹æ³• <code>æ˜ å°„</code>ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">.map(GET, &quot;/&quot;, request -&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .withHtml(&quot;&lt;h1&gt;Go to some pages&lt;/h1&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;&lt;a href=\&quot;/path1\&quot;&gt; Path 1 &lt;/a&gt;&lt;br&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;&lt;a href=\&quot;/path2\&quot;&gt; Path 2 &lt;/a&gt;&lt;br&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;&lt;a href=\&quot;/user/0\&quot;&gt; Data for user with ID 0 &lt;/a&gt;&lt;br&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;&lt;br&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;&lt;a href=\&quot;/path3\&quot;&gt; Non existent &lt;/a&gt;&quot;))</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><ul><li><em>æ–¹æ³•</em> ï¼ˆå¯é€‰ï¼‰æ˜¯HTTPæ–¹æ³•ä¹‹ä¸€ï¼ˆ<code>GET</code>ï¼Œ <code>POST</code>ï¼Œç­‰ç­‰ï¼‰ã€‚</li><li><em>path</em> æ˜¯æœåŠ¡å™¨ä¸Šçš„è·¯å¾„ã€‚</li><li><em>servlet</em> å®šä¹‰äº†è¯·æ±‚å¤„ç†çš„é€»è¾‘ã€‚
æ•´ä¸ªservletæ ‘å°†çœ‹èµ·æ¥å¦‚ä¸‹ã€‚</li></ul><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">@Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">AsyncServlet servlet() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return RoutingServlet.create()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      //[START REGION_2]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(GET, &quot;/&quot;, request -&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">              .withHtml(&quot;&lt;h1&gt;Go to some pages&lt;/h1&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                  &quot;&lt;a href=\&quot;/path1\&quot;&gt; Path 1 &lt;/a&gt;&lt;br&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                  &quot;&lt;a href=\&quot;/path2\&quot;&gt; Path 2 &lt;/a&gt;&lt;br&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                  &quot;&lt;a href=\&quot;/user/0\&quot;&gt; Data for user with ID 0 &lt;/a&gt;&lt;br&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                  &quot;&lt;br&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                  &quot;&lt;a href=\&quot;/path3\&quot;&gt; Non existent &lt;/a&gt;&quot;))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      //[END REGION_2]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(GET, &quot;/path1&quot;, request -&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">              .withHtml(&quot;&lt;h1&gt;Hello from the first path!&lt;/h1&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                  &quot;&lt;a href=\&quot;/\&quot;&gt;Go home&lt;/a&gt;&quot;))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(GET, &quot;/path2&quot;, request -&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">              .withHtml(&quot;&lt;h1&gt;Hello from the second path!&lt;/h1&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                  &quot;&lt;a href=\&quot;/\&quot;&gt;Go home&lt;/a&gt;&quot;))</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      //[START REGION_3]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(GET, &quot;/user/:user_id&quot;, request -&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        String userId = request.getPathParameter(&quot;user_id&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            .withHtml(&quot;&lt;h1&gt;You have requested data for user with ID: &quot; + userId + &quot;&lt;/h1&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;&lt;h3&gt;Try changing URL after &lt;i&gt;&#x27;.../user/&#x27;&lt;/i&gt; to get data for users with different IDs&lt;/h3&gt;&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      })</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      //[END REGION_3]</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      //[START REGION_4]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(&quot;/*&quot;, request -&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          HttpResponse.ofCode(404)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">              .withHtml(&quot;&lt;h1&gt;404&lt;/h1&gt;&lt;p&gt;Path &#x27;&quot; + request.getRelativePath() + &quot;&#x27; not found&lt;/p&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                  &quot;&lt;a href=\&quot;/\&quot;&gt;Go home&lt;/a&gt;&quot;));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      //[END REGION_4]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>ä½ å¯ä»¥ç”¨ <code>/:param</code> è¯­æ³•æ¥æ˜ å°„è·¯å¾„å‚æ•°ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">.map(GET, &quot;/user/:user_id&quot;, request -&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  String userId = request.getPathParameter(&quot;user_id&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .withHtml(&quot;&lt;h1&gt;You have requested data for user with ID: &quot; + userId + &quot;&lt;/h1&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          &quot;&lt;h3&gt;Try changing URL after &lt;i&gt;&#x27;.../user/&#x27;&lt;/i&gt; to get data for users with different IDs&lt;/h3&gt;&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>è·¯å¾„å‚æ•°å¯ä»¥é€šè¿‡è°ƒç”¨ <code>HttpRequest#getPathParameter</code> æ–¹æ³•å¹¶ä¼ é€’è·¯å¾„å‚æ•°çš„åç§°æ¥æ£€ç´¢ã€‚
ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨é€šé…ç¬¦è·¯ç”± <code>*</code>ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">.map(&quot;/*&quot;, request -&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    HttpResponse.ofCode(404)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .withHtml(&quot;&lt;h1&gt;404&lt;/h1&gt;&lt;p&gt;Path &#x27;&quot; + request.getRelativePath() + &quot;&#x27; not found&lt;/p&gt;&quot; +</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;&lt;a href=\&quot;/\&quot;&gt;Go home&lt;/a&gt;&quot;));</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p><code>*</code> è¯´æ˜æ— è®ºæ”¶åˆ°å“ªä¸€ä¸ªä¸‹ä¸€ä¸ªè·¯å¾„æ®µï¼Œéƒ½å°†ç”±è¿™ä¸ªServletæ¥å¤„ç†ã€‚
è¦æ£€æŸ¥è¿™ä¸ªä¾‹å­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæ‰“å¼€ä½ å–œæ¬¢çš„æµè§ˆå™¨ï¼Œè¿›å…¥ <a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">localhost:8080</a>
<a href="#"><a style="display:block;margin-bottom:16px" href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/RoutingServletExample.java" target="_blank">See full example on GitHub</a></a></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="åŠ¨æ€è·¯ç”±çš„ä¾‹å­">åŠ¨æ€è·¯ç”±çš„ä¾‹å­<a aria-hidden="true" class="hash-link" href="#åŠ¨æ€è·¯ç”±çš„ä¾‹å­" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p>æœ‰å‡ ä¸ªä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ä¸€äº›åŠ¨æ€å€¼è€Œä¸æ˜¯é¢„å®šä¹‰è·¯å¾„æ¥è·¯ç”±HTTPè¯·æ±‚ã€‚</p><ul><li><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/HostRoutingExample.java" target="_blank">Routing based on host</a></li><li><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/MimeTypeRoutingExample.java" target="_blank">Routing based on MIME type</a></li><li><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/CookieRoutingExample.java" target="_blank">Routing based on Cookie</a></li><li><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/DynamicRoutingExample.java" target="_blank">Randomized routing</a></li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="routing-servlet-multibinder">Routing Servlet Multibinder<a aria-hidden="true" class="hash-link" href="#routing-servlet-multibinder" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p>ä½¿ç”¨ <a href="/zh/inject">ä¾èµ–æ€§æ³¨å…¥</a> ï¼Œä½ å¯ä»¥åœ¨ä¸åŒçš„æ¨¡å—ä¸­æä¾› <code>RoutingServlet</code>sã€‚ è¿™æ ·çš„ç»‘å®šä¼šå¯¼è‡´ <strong>DI</strong> æŠ›å‡ºä¸€ä¸ªå†²çªé”®çš„å¼‚å¸¸ <code>RoutingServlet.class</code>ã€‚ ç„¶è€Œï¼Œä½ å¯ä»¥æŒ‡ç¤º <strong>DI</strong> ï¼Œé€šè¿‡å°† <code>RoutingServlet</code>såˆå¹¶æˆä¸€ä¸ªå•ä¸€çš„ <code>RoutingServlet</code> ï¼Œå…¶ä¸­åŒ…å«å…¶ä»–è·¯ç”±servletä¸­æŒ‡å®šçš„æ‰€æœ‰è·¯ç”±æ¥è§£å†³å†²çªã€‚
åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å£°æ˜äº†å‡ ä¸ªæ¨¡å—ï¼Œä¸º <code>RoutingServlet</code> ï¼Œæä¾›ä¸åŒçš„è·¯ç”±ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">private static final class ModuleA extends AbstractModule {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  RoutingServlet servlet() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return RoutingServlet.create()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .map(GET, &quot;/a&quot;, request -&gt; HttpResponse.ok200().withPlainText(&quot;Hello from &#x27;/a&#x27; path\n&quot;))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .map(GET, &quot;/b&quot;, request -&gt; HttpResponse.ok200().withPlainText(&quot;Hello from &#x27;/b&#x27; path\n&quot;))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .map(GET, &quot;/&quot;, request -&gt; HttpResponse.ok200().withPlainText(&quot;Hello from &#x27;/&#x27; path\n&quot;));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">private static final class ModuleB extends AbstractModule {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  RoutingServlet servlet() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return RoutingServlet.create()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .map(GET, &quot;/a/b&quot;, request -&gt; HttpResponse.ok200().withPlainText(&quot;Hello from &#x27;/a/b&#x27; path\n&quot;))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .map(GET, &quot;/b/a&quot;, request -&gt; HttpResponse.ok200().withPlainText(&quot;Hello from &#x27;/b/a&#x27; path\n&quot;))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .map(GET, &quot;/d&quot;, request -&gt; HttpResponse.ok200().withPlainText(&quot;Hello from &#x27;/d&#x27; path\n&quot;));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">private static final class ModuleC extends AbstractModule {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  RoutingServlet servlet() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return RoutingServlet.create()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .map(GET, &quot;/a/c&quot;, request -&gt; HttpResponse.ok200().withPlainText(&quot;Hello from &#x27;/a/c&#x27; path\n&quot;))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .map(GET, &quot;/b/c&quot;, request -&gt; HttpResponse.ok200().withPlainText(&quot;Hello from &#x27;/b/c&#x27; path\n&quot;))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .map(POST, &quot;/d&quot;, request -&gt; HttpResponse.ok200().withPlainText(&quot;Hello from POST &#x27;/d&#x27; path\n&quot;));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª <a href="https://github.com/activej/activej/blob/v5.0/core-inject/src/main/java/io/activej/inject/binding/Multibinder.java" target="_blank">Multibinder</a> ï¼Œå®ƒå¯ä»¥åˆå¹¶ç›¸äº’å†²çªçš„Servletã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">public static final Multibinder&lt;RoutingServlet&gt; SERVLET_MULTIBINDER = Multibinders.ofBinaryOperator((servlet1, servlet2) -&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    servlet1.merge(servlet2));</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>æœ€åï¼Œæˆ‘ä»¬è¦†ç›– <code>HttpServerLauncher#getBusinesLogicModule</code> æ–¹æ³•ï¼Œä»¥æä¾›ä¸€ä¸ªç»„åˆçš„DI <code>æ¨¡å—</code> ï¼Œå…¶ä¸­åŒ…å« <code>ModuleA</code>ï¼Œ <code>ModuleB</code>ï¼Œ <code>ModuleC</code> ï¼Œä»¥åŠä¸€ä¸ªå®‰è£…äº† <code>Multibinder</code> çš„DI Key <code>RoutingServlet.class</code>ã€‚
å¦‚æœæˆ‘ä»¬å¯åŠ¨è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ²¡æœ‰å†²çªï¼Œå› ä¸ºå†²çªçš„Servletè¢«æˆåŠŸåœ°åˆå¹¶åœ¨ä¸€èµ·ã€‚ æˆ‘ä»¬å¯èƒ½ä¼šæ‰“å¼€ä¸€ä¸ªç½‘ç»œæµè§ˆå™¨ï¼Œè®¿é—®ä»»ä½•ä¸€ä¸ªæŒ‡å®šçš„è·¯çº¿ï¼Œä»¥ç¡®ä¿è·¯ç”±çš„æ­£å¸¸è¿è¡Œã€‚</p><ul><li><a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">/</a></li><li><a href="http://localhost:8080/a" target="_blank" rel="noopener noreferrer">/a</a></li><li><a href="http://localhost:8080/a/b" target="_blank" rel="noopener noreferrer">/a/b</a></li><li><a href="http://localhost:8080/a/c" target="_blank" rel="noopener noreferrer">/a/c</a></li><li><a href="http://localhost:8080/b" target="_blank" rel="noopener noreferrer">/b</a></li><li><a href="http://localhost:8080/b/a" target="_blank" rel="noopener noreferrer">/b/a</a></li><li><a href="http://localhost:8080/b/c" target="_blank" rel="noopener noreferrer">/b/c</a></li><li><a href="http://localhost:8080/d" target="_blank" rel="noopener noreferrer">/d</a><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>å¦‚æœä½ è¯•å›¾åˆå¹¶æ˜ å°„æœ‰ç›¸åŒè·¯ç”±çš„RoutingServletsï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªå¼‚å¸¸</p></div></div></li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="routing-servletç¤ºä¾‹-1">Routing Servletç¤ºä¾‹<a aria-hidden="true" class="hash-link" href="#routing-servletç¤ºä¾‹-1" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p>å±•ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥å¤„ç†ä¸€äº›å¤æ‚çš„æ“ä½œã€‚ <a href="https://github.com/activej/activej/blob/v5.0/core-http/src/main/java/io/activej/http/BlockingServlet.java" target="_blank">BlockingServlet</a></p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">@Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">AsyncServlet servlet(Executor executor) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return RoutingServlet.create()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(&quot;/&quot;, request -&gt; HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          .withHtml(&quot;&lt;a href=&#x27;hardWork&#x27;&gt;Do hard work&lt;/a&gt;&quot;))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(&quot;/hardWork&quot;, AsyncServlet.ofBlocking(executor, request -&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Thread.sleep(2000); //Hard work</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            .withHtml(&quot;Hard work is done&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      }));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>è¦æ£€æŸ¥è¿™ä¸ªä¾‹å­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæ‰“å¼€ä½ å–œæ¬¢çš„æµè§ˆå™¨ï¼Œè¿›å…¥ <a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">localhost:8080</a>
<a href="#"><a style="display:block;margin-bottom:16px" href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/BlockingServletExample.java" target="_blank">See full example on GitHub</a></a></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="æ–‡ä»¶ä¸Šä¼ ç¤ºä¾‹">æ–‡ä»¶ä¸Šä¼ ç¤ºä¾‹<a aria-hidden="true" class="hash-link" href="#æ–‡ä»¶ä¸Šä¼ ç¤ºä¾‹" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç”¨æˆ·ä»æœ¬åœ°å­˜å‚¨ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åˆ°æœåŠ¡å™¨ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">@Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">AsyncServlet servlet(Executor executor) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return RoutingServlet.create()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(&quot;/&quot;, request -&gt; HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          .withHtml(&quot;&lt;a href=&#x27;hardWork&#x27;&gt;Do hard work&lt;/a&gt;&quot;))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(&quot;/hardWork&quot;, AsyncServlet.ofBlocking(executor, request -&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Thread.sleep(2000); //Hard work</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return HttpResponse.ok200()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            .withHtml(&quot;Hard work is done&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      }));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>è¦æ£€æŸ¥è¿™ä¸ªä¾‹å­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæ‰“å¼€ä½ å–œæ¬¢çš„æµè§ˆå™¨ï¼Œè¿›å…¥ <a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">localhost:8080</a>
<a href="#"><a style="display:block;margin-bottom:16px" href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/FileUploadExample.java" target="_blank">See full example on GitHub</a></a></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="å®¢æˆ·å®ä¾‹">å®¢æˆ·å®ä¾‹<a aria-hidden="true" class="hash-link" href="#å®¢æˆ·å®ä¾‹" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p>è¿™ä¸ªä¾‹å­æ˜¾ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <strong>Launcher</strong>ã€é¢„å®šä¹‰çš„ <a href="https://github.com/activej/activej/blob/v5.0/core-http/src/main/java/io/activej/http/AsyncHttpClient.java" target="_blank">AsyncHttpClient</a>ã€ å’Œ <a href="https://github.com/activej/activej/blob/v5.0/core-http/src/main/java/io/activej/dns/AsyncDnsClient.java" target="_blank">AsyncDnsClient</a> ï¼ˆå°†ç»™å®šçš„åŸŸåæ˜ å°„åˆ°ç›¸åº”çš„IPåœ°å€ï¼‰åˆ›å»ºä¸€ä¸ªHTTPå®¢æˆ·ç«¯ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">@Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">AsyncHttpClient client(Eventloop eventloop, AsyncDnsClient dnsClient) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return AsyncHttpClient.create(eventloop)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .withDnsClient(dnsClient);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">@Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">AsyncDnsClient dnsClient(Eventloop eventloop, Config config) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return RemoteAsyncDnsClient.create(eventloop)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .withDnsServerAddress(config.get(ofInetAddress(), &quot;dns.address&quot;))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .withTimeout(config.get(ofDuration(), &quot;dns.timeout&quot;));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>ä¸ºäº†ç»™ <code>AsyncHttpClient</code> ï¼Œæ·»åŠ å¯¹HTTPSçš„æ”¯æŒï¼Œä½ éœ€è¦è°ƒç”¨ <code>withSslEnabled</code> æ–¹æ³•ï¼Œå¹¶ä¼ é€’ <code>SSLContext</code> å’Œ <code>Executor</code></p></div></div><p>è¦†ç›–Launcher <code>getModule</code> æ–¹æ³•ï¼Œä»¥æä¾›æ‰€éœ€çš„ <a href="/zh/boot/config">configs</a> å’Œ <a href="/zh/boot/servicegraph">ServiceGraph</a> dependency graphã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">protected Module getModule() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return combine(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      ServiceGraphModule.create(),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      ConfigModule.create()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          .withEffectiveConfigLogger());</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">@Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Config config() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return Config.create()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .with(&quot;dns.address&quot;, &quot;8.8.8.8&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .with(&quot;dns.timeout&quot;, &quot;5 seconds&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .overrideWith(Config.ofSystemProperties(&quot;config&quot;));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>ç”±äºæˆ‘ä»¬çš„å®¢æˆ·ç«¯æ‰©å±•äº† <code>Launcher</code>ï¼Œå®ƒé‡å†™äº†å®šä¹‰ä¸»è¦åŠŸèƒ½çš„æ–¹æ³• <code>run</code>ã€‚ åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œå®ƒ å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œç­‰å¾…æœåŠ¡å™¨å“åº”ï¼ˆæ— è®ºæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼‰ï¼Œç„¶åå¤„ç†å®ƒã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">protected void run() throws ExecutionException, InterruptedException {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  String url = args.length != 0 ? args[0] : &quot;http://127.0.0.1:8080/&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  System.out.println(&quot;\nHTTP request: &quot; + url);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  CompletableFuture&lt;String&gt; future = eventloop.submit(() -&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      httpClient.request(HttpRequest.get(url))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          .then(response -&gt; response.loadBody())</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          .map(body -&gt; body.getString(UTF_8))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  System.out.println(&quot;HTTP response: &quot; + future.get());</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  System.out.println();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p><code>eventloop.submit</code> å°†è¯·æ±‚å‘é€å’Œå“åº”æ¥æ”¶æäº¤ç»™eventloopçº¿ç¨‹ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬çš„ä¸»çº¿ç¨‹å°†ç­‰å¾…ï¼Œç›´åˆ° <em>future</em> åœ¨äº‹ä»¶å¾ªç¯çº¿ç¨‹ä¸­è¿”å›ä¸€ä¸ªç»“æœï¼Œç„¶åæ‰å°†å“åº”æ‰“å°å‡ºæ¥ã€‚
è¦æ£€æŸ¥å®¢æˆ·ç«¯æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¯åŠ¨ <a href="#simple-hello-world-server">ç®€å•çš„ &quot;Hello World &quot;æœåŠ¡å™¨</a> æˆ– <a href="#custom-server">è‡ªå®šä¹‰HTTPæœåŠ¡å™¨</a> ï¼Œç„¶åè¿è¡Œ <strong>ClientExample</strong>
<a href="#"><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/HttpClientExample.java" target="_blank">See full example on GitHub</a></a></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="multipart-data-handling-example">Multipart Data Handling Example<a aria-hidden="true" class="hash-link" href="#multipart-data-handling-example" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p>POSTè¯·æ±‚æœ‰æ—¶å¯èƒ½è¢«ç¼–ç ä¸º <strong>Multipart/form-data</strong>ã€‚ æ­¤ç±»è¯·æ±‚å¯èƒ½åŒ…å«å¤šä¸ªå­—æ®µå’Œæ–‡ä»¶ã€‚ ä¸ºäº†å¤„ç†ä¸€ä¸ªåŒ…å«å¤šéƒ¨åˆ†æ•°æ®çš„è¯·æ±‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>HttpRequest#handleMultipart</code> æ–¹æ³•ã€‚ ä½ éœ€è¦å°† <code>MultipartDataHandler</code> çš„ä¸€ä¸ªå®ä¾‹ä¼ é€’ç»™è¿™ä¸ªæ–¹æ³•ã€‚ <code>MultipartDataHandler</code> ç±»ä¸­æœ‰å‡ ä¸ªå¸¸è§çš„å¤„ç†ç¨‹åºã€‚ ä½ å¯ä»¥ç”¨å®ƒä»¬æ¥æ”¶é›†å­—æ®µåˆ°åœ°å›¾ä¸Šï¼Œå‘é€ä¸€ä¸ªæ–‡ä»¶åˆ°ä¸€äº› <code>ChannelConsumer&lt;ByteBuf&gt;</code>ï¼Œç­‰ç­‰ã€‚ æˆ–è€…ä½ å¯ä»¥ç¼–å†™ä½ è‡ªå·±çš„ <code>MultipartDataHandler</code> ï¼Œå¦‚æœè¿™è¿˜ä¸å¤Ÿã€‚
åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†æ”¶é›†å­—æ®µåˆ°ä¸€ä¸ªåœ°å›¾ä¸Šï¼Œå¹¶å°†æ”¶åˆ°çš„æ–‡ä»¶ä¸Šä¼ åˆ°æŸä¸ªç›®å½•ã€‚ åœ¨è¿™ä¹‹åï¼Œæˆ‘ä»¬å°†è®°å½•æ”¶é›†çš„å­—æ®µå’Œä¸Šä¼ çš„æ–‡ä»¶æ•°é‡ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">@Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">AsyncServlet servlet() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return RoutingServlet.create()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(POST, &quot;/handleMultipart&quot;, request -&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Map&lt;String, String&gt; fields = new HashMap&lt;&gt;();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return request.handleMultipart(MultipartDataHandler.fieldsToMap(fields, this::upload))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            .map($ -&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">              logger.info(&quot;Received fields: {}&quot;, fields);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">              logger.info(&quot;Uploaded {} files total&quot;, fileUploadsCount);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">              return HttpResponse.ok200();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      });</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>ä¸ºäº†å°†æ”¶åˆ°çš„æ–‡ä»¶ä¸Šä¼ åˆ°æ–‡ä»¶ç³»ç»Ÿï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <a href="https://github.com/activej/activej/blob/v5.0/core-csp/src/main/java/io/activej/csp/file/ChannelFileWriter.java" target="_blank">ChannelFileWritter</a>ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">private @NotNull Promise&lt;ChannelConsumer&lt;ByteBuf&gt;&gt; upload(String filename) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  logger.info(&quot;Uploading file &#x27;{}&#x27; to {}&quot;, filename, path);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return ChannelFileWriter.open(executor, path.resolve(filename))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .map(writer -&gt; writer.withAcknowledgement(ack -&gt;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          ack.whenResult(() -&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            logger.info(&quot;Upload of file &#x27;{}&#x27; finished&quot;, filename);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            fileUploadsCount++;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          })));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p><strong>Multipart/form-data</strong> è¯·æ±‚æ˜¯æ‰‹åŠ¨ä¼ªé€ çš„ï¼ŒåŒ…å«å‡ ä¸ªå­—æ®µå’Œæ–‡ä»¶ã€‚ è¿è¡Œè¯¥ä¾‹å­åï¼Œä½  ï¼Œåº”è¯¥çœ‹åˆ°ç±»ä¼¼çš„æ—¥å¿—è¾“å‡ºã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W text"><pre tabindex="0" class="prism-code language-text codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">ä¸Šä¼ æ–‡ä»¶&#x27;data.txt&#x27;åˆ°/tmp/multipart-data-files4909047508332989372</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ä¸Šä¼ æ–‡ä»¶&#x27;data.txt&#x27;å®Œæˆ</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ä¸Šä¼ æ–‡ä»¶&#x27;key.txt&#x27;åˆ°/tmp/multipart-data-files4909047508332989372</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ä¸Šä¼ æ–‡ä»¶&#x27;key.txt&#x27;å®Œæˆ</span></span><span class="token-line" style="color:#393A34"><span class="token plain">æ¥æ”¶åˆ°å­—æ®µã€‚{last name=Johnson, first name=Alice, id=12345}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">å…±ä¸Šä¼ äº†2ä¸ªæ–‡ä»¶</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>ä½ å¯ä»¥ä»æ—¥å¿—è¾“å‡ºä¸­æ£€æŸ¥è¯¥ç›®å½•ï¼Œä»¥ç¡®ä¿æ–‡ä»¶è¢«ä¸Šä¼ ã€‚</p><p><a href="#"><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/MultipartDataHandlingExample.java" target="_blank">See full example on GitHub</a></a></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="websocket-pongæœåŠ¡å™¨">WebSocket PongæœåŠ¡å™¨<a aria-hidden="true" class="hash-link" href="#websocket-pongæœåŠ¡å™¨" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p>è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª &quot;Pong &quot;WebSocketæœåŠ¡å™¨ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ ï¼Œæä¾›ä¸€ä¸ª <code>RoutingServlet</code> ï¼Œå¹¶ä½¿ç”¨ <em>mapWebSocket</em> æ–¹æ³•ï¼Œå°† <strong>WebSocket</strong> çš„ä¸€ä¸ª <strong>Consumer</strong> æ˜ å°„ä¸º <code>/</code>è·¯å¾„ä¸Šçš„ä¸€ä¸ªServletã€‚ æˆ‘ä»¬çš„æœåŠ¡å™¨å°†ç®€å•åœ°æ¥å—ä¿¡æ¯ï¼Œå°†å…¶æ‰“å°å‡ºæ¥ï¼Œå¹¶æµå›ä¸€ä¸ª &quot;Pong &quot;ä¿¡æ¯ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">@Provides</span></span><span class="token-line" style="color:#393A34"><span class="token plain">AsyncServlet servlet() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  return RoutingServlet.create()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      .mapWebSocket(&quot;/&quot;, webSocket -&gt; webSocket.readMessage()</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          .whenResult(message -&gt; System.out.println(&quot;Received:&quot; + message.getText()))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          .then(() -&gt; webSocket.writeMessage(Message.text(&quot;Pong&quot;)))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">          .whenComplete(webSocket::close));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p><a href="#"><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/WebSocketPongServerExample.java" target="_blank">See full example on GitHub</a></a></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="websocket-pingå®¢æˆ·ç«¯">WebSocket Pingå®¢æˆ·ç«¯<a aria-hidden="true" class="hash-link" href="#websocket-pingå®¢æˆ·ç«¯" title="ç›´æ¥é“¾æ¥åˆ°æ ‡é¢˜">â€‹</a></h3><p>ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå®ƒå°†é€šè¿‡WebSocketè¿æ¥å‘æœåŠ¡å™¨å‘é€ &quot;Ping &quot;æ¶ˆæ¯ã€‚</p><div class="codeBlockContainer_2gih"><div class="codeBlockContent_3z4W java"><pre tabindex="0" class="prism-code language-java codeBlock_6upA thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xlV7"><span class="token-line" style="color:#393A34"><span class="token plain">@Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">protected void run() throws ExecutionException, InterruptedException {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  String url = args.length != 0 ? args[0] : &quot;ws://127.0.0.1:8080/&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  System.out.println(&quot;\nWeb Socket request: &quot; + url);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  CompletableFuture&lt;?&gt; future = eventloop.submit(() -&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(&quot;Sending: Ping&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return httpClient.webSocketRequest(HttpRequest.get(url))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        .then(webSocket -&gt; webSocket.writeMessage(Message.text(&quot;Ping&quot;))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            .then(webSocket::readMessage)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            .whenResult(message -&gt; System.out.println(&quot;Received: &quot; + message.getText()))</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            .whenComplete(webSocket::close));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  });</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  future.get();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" class="copyButton_2e3i clean-btn">æ‹·è´</button></div></div><p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªä¾›åº”å•†ï¼Œå¹¶é€šè¿‡lambdaé‡å†™å…¶ <code>get</code> æ–¹æ³•ã€‚ è¿™é‡Œæˆ‘ä»¬è°ƒç”¨ <code>AsyncHttpClient.webSocketRequest</code> ï¼Œå®ƒå‘é€ä¸€ä¸ªè¯·æ±‚å¹¶è¿”å›ä¸€ä¸ªPromiseçš„ <a href="https://github.com/activej/activej/blob/v5.0/core-http/src/main/java/io/activej/http/WebSocket.java" target="_blank"><code>WebSocket</code></a>. ç„¶åæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª <code>å‡½æ•°</code> ï¼Œå‘é€ä¸€ä¸ª &quot;Ping &quot;æ¶ˆæ¯ï¼Œå¹¶ä»æœåŠ¡å™¨æ¥æ”¶ä¸€ä¸ªå“åº”ã€‚</p><p><a href="#"><a href="https://github.com/activej/activej/blob/examples-5.0/examples/core/http/src/main/java/WebSocketPingClientExample.java" target="_blank">See full example on GitHub</a></a></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="æ–‡æ¡£é¡µé¢å¯¼èˆª"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh/http/benchmarks"><div class="pagination-nav__sublabel">ä¸Šä¸€ç¯‡</div><div class="pagination-nav__label">Â« <!-- -->åŸºå‡†</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zh/inject"><div class="pagination-nav__sublabel">ä¸‹ä¸€é¡µ</div><div class="pagination-nav__label">æ¦‚è¿°<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ç®€å•çš„-hello-world-æœåŠ¡å™¨" class="table-of-contents__link toc-highlight">ç®€å•çš„ &quot;Hello World &quot;æœåŠ¡å™¨</a></li><li><a href="#å¸¦æœ‰é¢„å®šä¹‰å¯åŠ¨å™¨çš„-hello-world-æœåŠ¡å™¨" class="table-of-contents__link toc-highlight">å¸¦æœ‰é¢„å®šä¹‰å¯åŠ¨å™¨çš„ &quot;Hello World &quot;æœåŠ¡å™¨</a></li><li><a href="#è‡ªå®šä¹‰æœåŠ¡å™¨" class="table-of-contents__link toc-highlight">è‡ªå®šä¹‰æœåŠ¡å™¨</a></li><li><a href="#å¤šçº¿ç¨‹æœåŠ¡å™¨å®ä¾‹" class="table-of-contents__link toc-highlight">å¤šçº¿ç¨‹æœåŠ¡å™¨å®ä¾‹</a></li><li><a href="#è¯·æ±‚å‚æ•°ç¤ºä¾‹" class="table-of-contents__link toc-highlight">è¯·æ±‚å‚æ•°ç¤ºä¾‹</a></li><li><a href="#é™æ€servletå®ä¾‹" class="table-of-contents__link toc-highlight">é™æ€Servletå®ä¾‹</a></li><li><a href="#routing-servletç¤ºä¾‹" class="table-of-contents__link toc-highlight">Routing Servletç¤ºä¾‹</a></li><li><a href="#åŠ¨æ€è·¯ç”±çš„ä¾‹å­" class="table-of-contents__link toc-highlight">åŠ¨æ€è·¯ç”±çš„ä¾‹å­</a></li><li><a href="#routing-servlet-multibinder" class="table-of-contents__link toc-highlight">Routing Servlet Multibinder</a></li><li><a href="#routing-servletç¤ºä¾‹-1" class="table-of-contents__link toc-highlight">Routing Servletç¤ºä¾‹</a></li><li><a href="#æ–‡ä»¶ä¸Šä¼ ç¤ºä¾‹" class="table-of-contents__link toc-highlight">æ–‡ä»¶ä¸Šä¼ ç¤ºä¾‹</a></li><li><a href="#å®¢æˆ·å®ä¾‹" class="table-of-contents__link toc-highlight">å®¢æˆ·å®ä¾‹</a></li><li><a href="#multipart-data-handling-example" class="table-of-contents__link toc-highlight">Multipart Data Handling Example</a></li><li><a href="#websocket-pongæœåŠ¡å™¨" class="table-of-contents__link toc-highlight">WebSocket PongæœåŠ¡å™¨</a></li><li><a href="#websocket-pingå®¢æˆ·ç«¯" class="table-of-contents__link toc-highlight">WebSocket Pingå®¢æˆ·ç«¯</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021å¹´ ActiveJ LLC.ä¿ç•™æ‰€æœ‰æƒåˆ©</div></div></div></footer></div>
<script src="/zh/assets/js/runtime~main.c90fdde9.js"></script>
<script src="/zh/assets/js/main.cfdcbb5a.js"></script>
</body>
</html>